"use strict";(self.webpackChunktunit_docs_site=self.webpackChunktunit_docs_site||[]).push([[6479],{12670:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"examples/aspnet","title":"ASP.NET Core Integration Testing","description":"TUnit provides first-class support for ASP.NET Core integration testing through the TUnit.AspNetCore package. This package enables per-test isolation with shared infrastructure, making it easy to write fast, parallel integration tests.","source":"@site/docs/examples/aspnet.md","sourceDirName":"examples","slug":"/examples/aspnet","permalink":"/docs/examples/aspnet","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"TUnit in CI/CD Pipelines","permalink":"/docs/examples/tunit-ci-pipeline"},"next":{"title":"Playwright","permalink":"/docs/examples/playwright"}}');var a=s(74848),i=s(28453);const r={},o="ASP.NET Core Integration Testing",l={},c=[{value:"Installation",id:"installation",level:2},{value:"Quick Start",id:"quick-start",level:2},{value:"1. Create a Test Factory",id:"1-create-a-test-factory",level:3},{value:"2. Create a Test Base Class",id:"2-create-a-test-base-class",level:3},{value:"3. Write Tests",id:"3-write-tests",level:3},{value:"Core Concepts",id:"core-concepts",level:2},{value:"WebApplicationTest Pattern",id:"webapplicationtest-pattern",level:3},{value:"Lifecycle Order",id:"lifecycle-order",level:3},{value:"Override Methods",id:"override-methods",level:2},{value:"SetupAsync",id:"setupasync",level:3},{value:"ConfigureTestServices",id:"configuretestservices",level:3},{value:"ConfigureTestConfiguration",id:"configuretestconfiguration",level:3},{value:"ConfigureWebHostBuilder",id:"configurewebhostbuilder",level:3},{value:"Test Isolation Helpers",id:"test-isolation-helpers",level:2},{value:"GetIsolatedName",id:"getisolatedname",level:3},{value:"GetIsolatedPrefix",id:"getisolatedprefix",level:3},{value:"Container Integration",id:"container-integration",level:2},{value:"With Testcontainers",id:"with-testcontainers",level:3},{value:"Per-Test Table Isolation",id:"per-test-table-isolation",level:3},{value:"HTTP Exchange Capture",id:"http-exchange-capture",level:2},{value:"Capture Options",id:"capture-options",level:3},{value:"Inspecting Captured Exchanges",id:"inspecting-captured-exchanges",level:3},{value:"TUnit Logging Integration",id:"tunit-logging-integration",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Use Base Classes for Common Setup",id:"1-use-base-classes-for-common-setup",level:3},{value:"2. Clean Up Resources",id:"2-clean-up-resources",level:3},{value:"3. Use Isolated Names for Shared Resources",id:"3-use-isolated-names-for-shared-resources",level:3},{value:"4. Inject Containers at Factory Level",id:"4-inject-containers-at-factory-level",level:3},{value:"Complete Example",id:"complete-example",level:2},{value:"Migrating from Basic WebApplicationFactory",id:"migrating-from-basic-webapplicationfactory",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"aspnet-core-integration-testing",children:"ASP.NET Core Integration Testing"})}),"\n",(0,a.jsxs)(n.p,{children:["TUnit provides first-class support for ASP.NET Core integration testing through the ",(0,a.jsx)(n.code,{children:"TUnit.AspNetCore"})," package. This package enables per-test isolation with shared infrastructure, making it easy to write fast, parallel integration tests."]}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"dotnet add package TUnit.AspNetCore\n"})}),"\n",(0,a.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,a.jsx)(n.h3,{id:"1-create-a-test-factory",children:"1. Create a Test Factory"}),"\n",(0,a.jsxs)(n.p,{children:["Create a factory that extends ",(0,a.jsx)(n.code,{children:"TestWebApplicationFactory<TEntryPoint>"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'using TUnit.AspNetCore;\nusing TUnit.Core.Interfaces;\n\npublic class WebApplicationFactory : TestWebApplicationFactory<Program>\n{\n    protected override void ConfigureWebHost(IWebHostBuilder builder)\n    {\n        // Configure shared services and settings\n        builder.ConfigureAppConfiguration((context, config) =>\n        {\n            config.AddInMemoryCollection(new Dictionary<string, string?>\n            {\n                { "ConnectionStrings:Default", "..." }\n            });\n        });\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"2-create-a-test-base-class",children:"2. Create a Test Base Class"}),"\n",(0,a.jsxs)(n.p,{children:["Create a base class that extends ",(0,a.jsx)(n.code,{children:"WebApplicationTest<TFactory, TEntryPoint>"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"using TUnit.AspNetCore;\n\npublic abstract class TestsBase : WebApplicationTest<WebApplicationFactory, Program>\n{\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"3-write-tests",children:"3. Write Tests"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'public class TodoApiTests : TestsBase\n{\n    [Test]\n    public async Task GetTodos_ReturnsOk()\n    {\n        var client = Factory.CreateClient();\n\n        var response = await client.GetAsync("/todos");\n\n        await Assert.That(response.StatusCode).IsEqualTo(HttpStatusCode.OK);\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,a.jsx)(n.h3,{id:"webapplicationtest-pattern",children:"WebApplicationTest Pattern"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"WebApplicationTest<TFactory, TEntryPoint>"})," base class provides:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Per-test isolation"}),": Each test gets its own delegating factory via ",(0,a.jsx)(n.code,{children:"WithWebHostBuilder"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Shared infrastructure"}),": The global factory (containers, connections) is shared across tests"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Parallel execution"}),": Tests run in parallel with complete isolation"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Lifecycle hooks"}),": Async setup runs before sync configuration"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"lifecycle-order",children:"Lifecycle Order"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"GlobalFactory"})," is injected (shared per test session)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"SetupAsync()"})," runs (for async operations like creating database tables)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ConfigureTestServices()"})," runs (sync, for DI configuration)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ConfigureTestConfiguration()"})," runs (sync, for app configuration)"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ConfigureWebHostBuilder()"})," runs (sync, escape hatch for advanced scenarios)"]}),"\n",(0,a.jsxs)(n.li,{children:["Test runs with isolated ",(0,a.jsx)(n.code,{children:"Factory"})]}),"\n",(0,a.jsx)(n.li,{children:"Factory is disposed"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"override-methods",children:"Override Methods"}),"\n",(0,a.jsx)(n.h3,{id:"setupasync",children:"SetupAsync"}),"\n",(0,a.jsx)(n.p,{children:"Use for async operations that must complete before the factory is created:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'public class TodoTests : TestsBase\n{\n    protected string TableName { get; private set; } = null!;\n\n    protected override async Task SetupAsync()\n    {\n        TableName = GetIsolatedName("todos");\n        await CreateTableAsync(TableName);\n    }\n\n    protected override void ConfigureTestConfiguration(IConfigurationBuilder config)\n    {\n        // TableName is already set from SetupAsync\n        config.AddInMemoryCollection(new Dictionary<string, string?>\n        {\n            { "Database:TableName", TableName }\n        });\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"configuretestservices",children:"ConfigureTestServices"}),"\n",(0,a.jsx)(n.p,{children:"Use for DI configuration:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"protected override void ConfigureTestServices(IServiceCollection services)\n{\n    // Replace a service with a mock\n    services.ReplaceService<IEmailService>(new FakeEmailService());\n\n    // Add test-specific services\n    services.AddSingleton<ITestHelper, TestHelper>();\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"configuretestconfiguration",children:"ConfigureTestConfiguration"}),"\n",(0,a.jsx)(n.p,{children:"Use for app configuration:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'protected override void ConfigureTestConfiguration(IConfigurationBuilder config)\n{\n    config.AddInMemoryCollection(new Dictionary<string, string?>\n    {\n        { "Feature:Enabled", "true" },\n        { "Api:BaseUrl", "https://test.example.com" }\n    });\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"configurewebhostbuilder",children:"ConfigureWebHostBuilder"}),"\n",(0,a.jsx)(n.p,{children:"Escape hatch for advanced scenarios:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'protected override void ConfigureWebHostBuilder(IWebHostBuilder builder)\n{\n    builder.UseEnvironment("Staging");\n    builder.UseSetting("MyFeature:Enabled", "true");\n    builder.ConfigureKestrel(options => options.AddServerHeader = false);\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"test-isolation-helpers",children:"Test Isolation Helpers"}),"\n",(0,a.jsx)(n.h3,{id:"getisolatedname",children:"GetIsolatedName"}),"\n",(0,a.jsx)(n.p,{children:"Creates a unique name for resources like database tables:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'// In a test with UniqueId = 42:\nvar tableName = GetIsolatedName("todos");  // Returns "Test_42_todos"\nvar topicName = GetIsolatedName("orders"); // Returns "Test_42_orders"\n'})}),"\n",(0,a.jsx)(n.h3,{id:"getisolatedprefix",children:"GetIsolatedPrefix"}),"\n",(0,a.jsx)(n.p,{children:"Creates a unique prefix for key-based resources:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'// In a test with UniqueId = 42:\nvar prefix = GetIsolatedPrefix();       // Returns "test_42_"\nvar dotPrefix = GetIsolatedPrefix("."); // Returns "test.42."\n'})}),"\n",(0,a.jsx)(n.h2,{id:"container-integration",children:"Container Integration"}),"\n",(0,a.jsx)(n.h3,{id:"with-testcontainers",children:"With Testcontainers"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'public class InMemoryDatabase : IAsyncInitializer, IAsyncDisposable\n{\n    public PostgreSqlContainer Container { get; } = new PostgreSqlBuilder()\n        .WithImage("postgres:16-alpine")\n        .Build();\n\n    public async Task InitializeAsync() => await Container.StartAsync();\n    public async ValueTask DisposeAsync() => await Container.DisposeAsync();\n}\n\npublic class WebApplicationFactory : TestWebApplicationFactory<Program>\n{\n    [ClassDataSource<InMemoryDatabase>(Shared = SharedType.PerTestSession)]\n    public InMemoryDatabase Database { get; init; } = null!;\n\n    protected override void ConfigureWebHost(IWebHostBuilder builder)\n    {\n        builder.ConfigureAppConfiguration((_, config) =>\n        {\n            config.AddInMemoryCollection(new Dictionary<string, string?>\n            {\n                { "Database:ConnectionString", Database.Container.GetConnectionString() }\n            });\n        });\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"per-test-table-isolation",children:"Per-Test Table Isolation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'public abstract class TodoTestBase : TestsBase\n{\n    [ClassDataSource<InMemoryDatabase>(Shared = SharedType.PerTestSession)]\n    public InMemoryDatabase Database { get; init; } = null!;\n\n    protected string TableName { get; private set; } = null!;\n\n    protected override async Task SetupAsync()\n    {\n        TableName = GetIsolatedName("todos");\n        await CreateTableAsync(TableName);\n    }\n\n    protected override void ConfigureTestConfiguration(IConfigurationBuilder config)\n    {\n        config.AddInMemoryCollection(new Dictionary<string, string?>\n        {\n            { "Database:TableName", TableName }\n        });\n    }\n\n    [After(HookType.Test)]\n    public async Task CleanupTable()\n    {\n        await DropTableAsync(TableName);\n    }\n\n    private async Task CreateTableAsync(string name) { /* ... */ }\n    private async Task DropTableAsync(string name) { /* ... */ }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"http-exchange-capture",children:"HTTP Exchange Capture"}),"\n",(0,a.jsx)(n.p,{children:"Capture and inspect HTTP requests/responses for assertions:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'public class CaptureTests : TestsBase\n{\n    protected override WebApplicationTestOptions Options => new()\n    {\n        EnableHttpExchangeCapture = true\n    };\n\n    [Test]\n    public async Task RequestIsCaptured()\n    {\n        var client = Factory.CreateClient();\n\n        await client.GetAsync("/api/todos");\n\n        await Assert.That(HttpCapture).IsNotNull();\n        await Assert.That(HttpCapture!.Last!.Response.StatusCode)\n            .IsEqualTo(HttpStatusCode.OK);\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"capture-options",children:"Capture Options"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"protected override WebApplicationTestOptions Options => new()\n{\n    EnableHttpExchangeCapture = true,\n    CaptureRequestBody = true,\n    CaptureResponseBody = true,\n    MaxBodySize = 1024 * 1024  // 1MB limit\n};\n"})}),"\n",(0,a.jsx)(n.h3,{id:"inspecting-captured-exchanges",children:"Inspecting Captured Exchanges"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'// Get the last exchange\nvar last = HttpCapture!.Last;\n\n// Get all exchanges\nvar all = HttpCapture.All;\n\n// Inspect request\nawait Assert.That(last!.Request.Method).IsEqualTo("POST");\nawait Assert.That(last.Request.Path).IsEqualTo("/api/todos");\nawait Assert.That(last.Request.Body).Contains("\\"title\\"");\n\n// Inspect response\nawait Assert.That(last.Response.StatusCode).IsEqualTo(HttpStatusCode.Created);\nawait Assert.That(last.Response.Body).Contains("\\"id\\"");\n'})}),"\n",(0,a.jsx)(n.h2,{id:"tunit-logging-integration",children:"TUnit Logging Integration"}),"\n",(0,a.jsx)(n.p,{children:"Server logs are automatically correlated with TUnit test output:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"protected override WebApplicationTestOptions Options => new()\n{\n    AddTUnitLogging = true  // Default is true\n};\n"})}),"\n",(0,a.jsx)(n.p,{children:"Logs from your ASP.NET Core app will appear in the test output, making debugging easier."}),"\n",(0,a.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,a.jsx)(n.h3,{id:"1-use-base-classes-for-common-setup",children:"1. Use Base Classes for Common Setup"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"// Shared base for all tests\npublic abstract class TestsBase : WebApplicationTest<WebApplicationFactory, Program>\n{\n}\n\n// Specialized base for database tests\npublic abstract class DatabaseTestBase : TestsBase\n{\n    protected override async Task SetupAsync()\n    {\n        await CreateSchemaAsync();\n    }\n}\n\n// Actual tests\npublic class UserTests : DatabaseTestBase\n{\n    [Test]\n    public async Task CreateUser_Works() { /* ... */ }\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"2-clean-up-resources",children:"2. Clean Up Resources"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"[After(HookType.Test)]\npublic async Task Cleanup()\n{\n    await CleanupTestDataAsync();\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"3-use-isolated-names-for-shared-resources",children:"3. Use Isolated Names for Shared Resources"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'protected override async Task SetupAsync()\n{\n    // Each test gets unique resources\n    var tableName = GetIsolatedName("users");\n    var cachePrefix = GetIsolatedPrefix();\n    var topicName = GetIsolatedName("events");\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"4-inject-containers-at-factory-level",children:"4. Inject Containers at Factory Level"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"public class WebApplicationFactory : TestWebApplicationFactory<Program>\n{\n    // Shared across all tests\n    [ClassDataSource<PostgresContainer>(Shared = SharedType.PerTestSession)]\n    public PostgresContainer Postgres { get; init; } = null!;\n\n    [ClassDataSource<RedisContainer>(Shared = SharedType.PerTestSession)]\n    public RedisContainer Redis { get; init; } = null!;\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"complete-example",children:"Complete Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'// Container wrapper\npublic class InMemoryPostgres : IAsyncInitializer, IAsyncDisposable\n{\n    public PostgreSqlContainer Container { get; } = new PostgreSqlBuilder().Build();\n    public async Task InitializeAsync() => await Container.StartAsync();\n    public async ValueTask DisposeAsync() => await Container.DisposeAsync();\n}\n\n// Factory with shared container\npublic class WebApplicationFactory : TestWebApplicationFactory<Program>\n{\n    [ClassDataSource<InMemoryPostgres>(Shared = SharedType.PerTestSession)]\n    public InMemoryPostgres Postgres { get; init; } = null!;\n\n    protected override void ConfigureWebHost(IWebHostBuilder builder)\n    {\n        builder.ConfigureAppConfiguration((_, config) =>\n        {\n            config.AddInMemoryCollection(new Dictionary<string, string?>\n            {\n                { "Database:ConnectionString", Postgres.Container.GetConnectionString() }\n            });\n        });\n    }\n}\n\n// Base class\npublic abstract class TestsBase : WebApplicationTest<WebApplicationFactory, Program>\n{\n}\n\n// Test base with table isolation\npublic abstract class TodoTestBase : TestsBase\n{\n    [ClassDataSource<InMemoryPostgres>(Shared = SharedType.PerTestSession)]\n    public InMemoryPostgres Postgres { get; init; } = null!;\n\n    protected string TableName { get; private set; } = null!;\n\n    protected override async Task SetupAsync()\n    {\n        TableName = GetIsolatedName("todos");\n        await CreateTableAsync();\n    }\n\n    protected override void ConfigureTestConfiguration(IConfigurationBuilder config)\n    {\n        config.AddInMemoryCollection(new Dictionary<string, string?>\n        {\n            { "Database:TableName", TableName }\n        });\n    }\n\n    [After(HookType.Test)]\n    public async Task Cleanup() => await DropTableAsync();\n\n    private async Task CreateTableAsync() { /* ... */ }\n    private async Task DropTableAsync() { /* ... */ }\n}\n\n// Actual tests\npublic class TodoApiTests : TodoTestBase\n{\n    [Test]\n    public async Task CreateTodo_ReturnsCreated()\n    {\n        var client = Factory.CreateClient();\n\n        var response = await client.PostAsJsonAsync("/todos", new { Title = "Test" });\n\n        await Assert.That(response.StatusCode).IsEqualTo(HttpStatusCode.Created);\n    }\n\n    [Test, Repeat(5)]\n    public async Task ParallelTests_AreIsolated()\n    {\n        var client = Factory.CreateClient();\n\n        // Each repetition has its own table\n        await client.PostAsJsonAsync("/todos", new { Title = "Isolated" });\n\n        var todos = await client.GetFromJsonAsync<List<Todo>>("/todos");\n        await Assert.That(todos!.Count).IsEqualTo(1);  // Always 1, not 5\n    }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"migrating-from-basic-webapplicationfactory",children:"Migrating from Basic WebApplicationFactory"}),"\n",(0,a.jsxs)(n.p,{children:["If you're currently using ",(0,a.jsx)(n.code,{children:"WebApplicationFactory<TEntryPoint>"})," directly:"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"Before:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"public class MyTests\n{\n    [ClassDataSource<WebAppFactory>(Shared = SharedType.PerTestSession)]\n    public required WebAppFactory Factory { get; init; }\n\n    [Test]\n    public async Task Test1()\n    {\n        var client = Factory.CreateClient();\n        // Tests share state - not isolated!\n    }\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"After:"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"public class MyTests : WebApplicationTest<WebAppFactory, Program>\n{\n    [Test]\n    public async Task Test1()\n    {\n        var client = Factory.CreateClient();  // Isolated per test!\n    }\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"The key benefits:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Each test gets its own isolated factory via ",(0,a.jsx)(n.code,{children:"WithWebHostBuilder"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"SetupAsync"})," enables async initialization before factory creation"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ConfigureTestServices"})," and ",(0,a.jsx)(n.code,{children:"ConfigureTestConfiguration"})," are per-test"]}),"\n",(0,a.jsxs)(n.li,{children:["Built-in isolation helpers (",(0,a.jsx)(n.code,{children:"GetIsolatedName"}),", ",(0,a.jsx)(n.code,{children:"GetIsolatedPrefix"}),")"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>o});var t=s(96540);const a={},i=t.createContext(a);function r(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);