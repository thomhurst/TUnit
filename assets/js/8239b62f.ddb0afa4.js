"use strict";(globalThis.webpackChunktunit_docs_site=globalThis.webpackChunktunit_docs_site||[]).push([[1253],{17980(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"test-authoring/mocking/verification","title":"Verification","description":"The mock.Verify surface checks that expected calls were made to the mock.","source":"@site/docs/test-authoring/mocking/verification.md","sourceDirName":"test-authoring/mocking","slug":"/test-authoring/mocking/verification","permalink":"/docs/test-authoring/mocking/verification","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docs","previous":{"title":"Setup & Stubbing","permalink":"/docs/test-authoring/mocking/setup"},"next":{"title":"Argument Matchers","permalink":"/docs/test-authoring/mocking/argument-matchers"}}');var r=i(74848),t=i(28453);const c={sidebar_position:3},a="Verification",l={},o=[{value:"Basic Verification",id:"basic-verification",level:2},{value:"Times",id:"times",level:3},{value:"Custom Failure Messages",id:"custom-failure-messages",level:3},{value:"Property Verification",id:"property-verification",level:2},{value:"Argument Matching in Verification",id:"argument-matching-in-verification",level:2},{value:"Ordered Verification",id:"ordered-verification",level:2},{value:"VerifyAll",id:"verifyall",level:2},{value:"VerifyNoOtherCalls",id:"verifynoothercalls",level:2},{value:"TUnit Assertion Integration",id:"tunit-assertion-integration",level:2},{value:"Inspecting Calls",id:"inspecting-calls",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"verification",children:"Verification"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"mock.Verify"})," surface checks that expected calls were made to the mock."]}),"\n",(0,r.jsx)(n.h2,{id:"basic-verification",children:"Basic Verification"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// Verify a method was called at least once\nmock.Verify.GetUser(42).WasCalled();\n\n// Verify exact call count\nmock.Verify.GetUser(42).WasCalled(Times.Once);\n\n// Verify never called\nmock.Verify.Delete(Arg.Any<int>()).WasNeverCalled();\n"})}),"\n",(0,r.jsx)(n.h3,{id:"times",children:"Times"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Expression"}),(0,r.jsx)(n.th,{children:"Matches"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Times.Once"})}),(0,r.jsx)(n.td,{children:"Exactly 1 call"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Times.Never"})}),(0,r.jsx)(n.td,{children:"Exactly 0 calls"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Times.AtLeastOnce"})}),(0,r.jsx)(n.td,{children:"1 or more calls"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Times.Exactly(n)"})}),(0,r.jsx)(n.td,{children:"Exactly n calls"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Times.AtLeast(n)"})}),(0,r.jsx)(n.td,{children:"n or more calls"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Times.AtMost(n)"})}),(0,r.jsx)(n.td,{children:"n or fewer calls"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"Times.Between(min, max)"})}),(0,r.jsx)(n.td,{children:"Between min and max calls (inclusive)"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"custom-failure-messages",children:"Custom Failure Messages"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'mock.Verify.GetUser(42).WasCalled(Times.Once, "GetUser should be called once during initialization");\nmock.Verify.Delete(Arg.Any<int>()).WasNeverCalled("Delete should not be called in read-only mode");\n'})}),"\n",(0,r.jsx)(n.h2,{id:"property-verification",children:"Property Verification"}),"\n",(0,r.jsxs)(n.p,{children:["Property verification mirrors the setup API \u2014 defaults to the ",(0,r.jsx)(n.strong,{children:"getter"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// Getter verification\nmock.Verify.Name.WasCalled(Times.Once);           // getter called once\nmock.Verify.Name.Getter.WasCalled(Times.Once);    // explicit \u2014 same as above\nmock.Verify.Name.WasNeverCalled();                 // getter never accessed\n\n// Setter verification \u2014 any value\nmock.Verify.Count.Setter.WasCalled(Times.Exactly(3));\nmock.Verify.Count.Setter.WasNeverCalled();\n\n// Setter verification \u2014 specific value\nmock.Verify.Count.Set(42).WasCalled(Times.Once);\nmock.Verify.Count.Set(Arg.Is<int>(v => v > 0)).WasCalled(Times.AtLeast(1));\n"})}),"\n",(0,r.jsx)(n.h2,{id:"argument-matching-in-verification",children:"Argument Matching in Verification"}),"\n",(0,r.jsxs)(n.p,{children:["Verification uses the same ",(0,r.jsx)(n.code,{children:"Arg<T>"})," matchers as setup:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"// Exact value\nmock.Verify.GetUser(42).WasCalled(Times.Once);\n\n// Any value\nmock.Verify.GetUser(Arg.Any<int>()).WasCalled(Times.Exactly(3));\n\n// Predicate\nmock.Verify.GetUser(Arg.Is<int>(id => id > 0)).WasCalled(Times.AtLeast(1));\n"})}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"argument-matchers",children:"Argument Matchers"})," for the full list of matchers."]}),"\n",(0,r.jsx)(n.h2,{id:"ordered-verification",children:"Ordered Verification"}),"\n",(0,r.jsxs)(n.p,{children:["Verify calls occurred in a specific order ",(0,r.jsx)(n.strong,{children:"across one or more mocks"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'Mock.VerifyInOrder(() =>\n{\n    mockLogger.Verify.Log("Starting").WasCalled();\n    mockRepo.Verify.SaveAsync(Arg.Any<int>()).WasCalled();\n    mockLogger.Verify.Log("Done").WasCalled();\n});\n'})}),"\n",(0,r.jsxs)(n.p,{children:["If calls occurred out of order, ",(0,r.jsx)(n.code,{children:"VerifyInOrder"})," throws with a message showing the actual sequence."]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"VerifyInOrder"})," uses a global sequence counter \u2014 it works across multiple independent mock instances, not just within a single mock."]})}),"\n",(0,r.jsx)(n.h2,{id:"verifyall",children:"VerifyAll"}),"\n",(0,r.jsxs)(n.p,{children:["Verify that ",(0,r.jsx)(n.strong,{children:"every setup"})," was invoked at least once:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'mock.Setup.GetUser(Arg.Any<int>()).Returns(new User("Alice"));\nmock.Setup.Delete(Arg.Any<int>());\n\nsvc.GetUser(1);\nsvc.Delete(2);\n\nmock.VerifyAll(); // passes \u2014 both setups were invoked\n'})}),"\n",(0,r.jsxs)(n.p,{children:["If any setup was never called, ",(0,r.jsx)(n.code,{children:"VerifyAll"})," throws listing the uninvoked setups."]}),"\n",(0,r.jsx)(n.h2,{id:"verifynoothercalls",children:"VerifyNoOtherCalls"}),"\n",(0,r.jsx)(n.p,{children:"Verify that all recorded calls have been explicitly verified:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"svc.GetUser(1);\nsvc.Delete(2);\n\nmock.Verify.GetUser(1).WasCalled(Times.Once);\nmock.Verify.Delete(2).WasCalled(Times.Once);\n\nmock.VerifyNoOtherCalls(); // passes \u2014 all calls accounted for\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If there are unverified calls, ",(0,r.jsx)(n.code,{children:"VerifyNoOtherCalls"})," throws listing them."]}),"\n",(0,r.jsx)(n.h2,{id:"tunit-assertion-integration",children:"TUnit Assertion Integration"}),"\n",(0,r.jsxs)(n.p,{children:["Use TUnit's ",(0,r.jsx)(n.code,{children:"Assert.That"})," pipeline for assertion-style verification with better error messages:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:"using TUnit.Mocks.Assertions;\n\nawait Assert.That(mock.Verify.GetUser(42)).WasCalled(Times.Once);\nawait Assert.That(mock.Verify.Delete(Arg.Any<int>())).WasNeverCalled();\n\n// Property verification through assertions\nawait Assert.That(mock.Verify.Name).WasCalled(Times.Once);\n"})}),"\n",(0,r.jsx)(n.p,{children:"This integrates with TUnit's assertion engine \u2014 failures appear as assertion errors with expression trees in the output."}),"\n",(0,r.jsx)(n.h2,{id:"inspecting-calls",children:"Inspecting Calls"}),"\n",(0,r.jsx)(n.p,{children:"Access the raw call history for custom inspection:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-csharp",children:'var calls = mock.Invocations;\n\nawait Assert.That(calls).HasCount().EqualTo(3);\nawait Assert.That(calls[0].MemberName).IsEqualTo("GetUser");\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Each ",(0,r.jsx)(n.code,{children:"CallRecord"})," contains the member name, arguments, and sequence number."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453(e,n,i){i.d(n,{R:()=>c,x:()=>a});var s=i(96540);const r={},t=s.createContext(r);function c(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);