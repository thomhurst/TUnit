"use strict";(self.webpackChunktunit_docs_site=self.webpackChunktunit_docs_site||[]).push([[6505],{63615:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>g,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"customization-extensibility/logging","title":"Logging","description":"By default, TUnit will intercept any logs to the Console, and attempt to correlate them to the test that triggered that log by the current async context that it is in.","source":"@site/docs/customization-extensibility/logging.md","sourceDirName":"customization-extensibility","slug":"/customization-extensibility/logging","permalink":"/docs/customization-extensibility/logging","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Display Names","permalink":"/docs/customization-extensibility/display-names"},"next":{"title":"Libraries","permalink":"/docs/customization-extensibility/libraries"}}');var o=n(74848),i=n(28453);const r={},l="Logging",a={},c=[{value:"Logger Objects",id:"logger-objects",level:2},{value:"Log Level",id:"log-level",level:2},{value:"Log Level Command Line",id:"log-level-command-line",level:2},{value:"Custom Loggers",id:"custom-loggers",level:2},{value:"Available Extension Points",id:"available-extension-points",level:3},{value:"Example: Adding Test Headers",id:"example-adding-test-headers",level:3},{value:"Using Custom Loggers",id:"using-custom-loggers",level:3},{value:"Example: Custom Output Destinations",id:"example-custom-output-destinations",level:3}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"logging",children:"Logging"})}),"\n",(0,o.jsxs)(t.p,{children:["By default, TUnit will intercept any logs to the ",(0,o.jsx)(t.code,{children:"Console"}),", and attempt to correlate them to the test that triggered that log by the current async context that it is in."]}),"\n",(0,o.jsxs)(t.p,{children:["So for most scenarios, you can just rely on ",(0,o.jsx)(t.code,{children:"Console.WriteLine(...)"}),"."]}),"\n",(0,o.jsx)(t.h2,{id:"logger-objects",children:"Logger Objects"}),"\n",(0,o.jsxs)(t.p,{children:["If you want a logger object, you can call ",(0,o.jsx)(t.code,{children:"TestContext.Current.GetDefaultLogger()\x13"}),", which will give you a logger that will write output to that test's output writer."]}),"\n",(0,o.jsx)(t.p,{children:"This logger can also be used to map to other logging interfaces (e.g. Microsoft.Extensions.Logging), so that for example, Asp.NET web apps can log to your test's context, so that you have a cleaner, more isolated log output."}),"\n",(0,o.jsx)(t.h2,{id:"log-level",children:"Log Level"}),"\n",(0,o.jsxs)(t.p,{children:["TUnit will use the same log level as provided to the Microsoft.Testing.Platform, which is set on the command line when invoking the test suite. If not defined, the default log level should be ",(0,o.jsx)(t.code,{children:"Trace"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["If you want to override this, you can inherit from ",(0,o.jsx)(t.code,{children:"TUnitLogger"})," or ",(0,o.jsx)(t.code,{children:"DefaultLogger"})," and override the ",(0,o.jsx)(t.code,{children:"IsEnabled"})," method:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-csharp",children:" public override bool IsEnabled(LogLevel logLevel)\n{\n    return logLevel >= LogLevel.Error;\n}\n"})}),"\n",(0,o.jsx)(t.h2,{id:"log-level-command-line",children:"Log Level Command Line"}),"\n",(0,o.jsxs)(t.p,{children:["If you are executing tests via the command line, you can set the log level via the ",(0,o.jsx)(t.code,{children:"--log-level"})," argument:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"dotnet run --log-level Warning\n"})}),"\n",(0,o.jsxs)(t.p,{children:["The above will show only logs that are ",(0,o.jsx)(t.code,{children:"Warning"})," or higher (e.g. ",(0,o.jsx)(t.code,{children:"Error"}),", ",(0,o.jsx)(t.code,{children:"Critical"}),") while executing the test."]}),"\n",(0,o.jsx)(t.h2,{id:"custom-loggers",children:"Custom Loggers"}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.code,{children:"DefaultLogger"})," class is designed to be extensible. You can inherit from it to customize message formatting and output behavior."]}),"\n",(0,o.jsx)(t.h3,{id:"available-extension-points",children:"Available Extension Points"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"Context"})," - Protected property to access the associated context"]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"GenerateMessage(string message, Exception? exception, LogLevel logLevel)"})," - Override to customize message formatting"]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"WriteToOutput(string message, bool isError)"})," - Override to customize how messages are written"]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"WriteToOutputAsync(string message, bool isError)"})," - Async version of WriteToOutput"]}),"\n"]}),"\n",(0,o.jsx)(t.h3,{id:"example-adding-test-headers",children:"Example: Adding Test Headers"}),"\n",(0,o.jsx)(t.p,{children:"Here's an example of a custom logger that prepends a test identifier header before the first log message:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-csharp",children:'public class TestHeaderLogger : DefaultLogger\n{\n    private bool _hasOutputHeader;\n\n    public TestHeaderLogger(Context context) : base(context) { }\n\n    protected override string GenerateMessage(string message, Exception? exception, LogLevel logLevel)\n    {\n        var baseMessage = base.GenerateMessage(message, exception, logLevel);\n\n        if (!_hasOutputHeader && Context is TestContext testContext)\n        {\n            _hasOutputHeader = true;\n            var testId = $"{testContext.TestDetails.ClassType.Name}.{testContext.TestDetails.TestName}";\n            return $"--- {testId} ---\\n{baseMessage}";\n        }\n\n        return baseMessage;\n    }\n}\n'})}),"\n",(0,o.jsx)(t.h3,{id:"using-custom-loggers",children:"Using Custom Loggers"}),"\n",(0,o.jsx)(t.p,{children:"Create an instance of your custom logger and use it directly:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-csharp",children:'[Test]\npublic async Task MyTest()\n{\n    var logger = new TestHeaderLogger(TestContext.Current!);\n    logger.LogInformation("This message will have a test header");\n    logger.LogInformation("Subsequent messages won\'t repeat the header");\n}\n'})}),"\n",(0,o.jsx)(t.h3,{id:"example-custom-output-destinations",children:"Example: Custom Output Destinations"}),"\n",(0,o.jsx)(t.p,{children:"You can override the write methods to send output to additional destinations:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-csharp",children:"public class MultiDestinationLogger : DefaultLogger\n{\n    private readonly TextWriter _additionalOutput;\n\n    public MultiDestinationLogger(Context context, TextWriter additionalOutput)\n        : base(context)\n    {\n        _additionalOutput = additionalOutput;\n    }\n\n    protected override void WriteToOutput(string message, bool isError)\n    {\n        base.WriteToOutput(message, isError);\n        _additionalOutput.WriteLine(message);\n    }\n}\n"})})]})}function g(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var s=n(96540);const o={},i=s.createContext(o);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);